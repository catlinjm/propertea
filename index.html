<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ProperTea</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css"/>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
:root {
  --ink: #1c2b1e; --hunter: #2d4a32; --hunter-mid: #3d6644; --hunter-light: #4e7d56;
  --paper: #f5f2ea; --cream: #e8e3d5; --brass: #a8893a; --brass-light: #d4bc7a;
  --slate: #4a5e4d; --white: #fdfbf5;
  --shadow: 0 4px 24px rgba(28,43,30,0.14); --radius: 10px;
}
html, body { height:100%; width:100%; overflow:hidden; font-family:'DM Sans',sans-serif; background:var(--paper); color:var(--ink); font-size:14px; display:flex; flex-direction:column; }
.toolbar { height:52px; background:var(--ink); display:flex; align-items:center; justify-content:space-between; padding:0 20px; flex-shrink:0; border-bottom:2px solid var(--hunter-mid); }
.logo { font-family:'Playfair Display',serif; font-size:1.25rem; font-weight:700; color:var(--brass-light); letter-spacing:0.03em; }
.logo span { color:rgba(245,242,234,0.85); font-weight:400; }
.filters { display:flex; gap:6px; align-items:center; }
.filter-btn { padding:5px 13px; border-radius:20px; border:1px solid rgba(168,137,58,0.35); background:transparent; color:rgba(245,242,234,0.6); font-family:'DM Sans',sans-serif; font-size:0.72rem; font-weight:500; cursor:pointer; transition:all 0.2s; letter-spacing:0.04em; text-transform:uppercase; }
.filter-btn.active, .filter-btn:hover { background:var(--brass); border-color:var(--brass); color:var(--white); }
.listing-count { font-size:0.7rem; color:rgba(245,242,234,0.3); margin-left:6px; }
.app { display:flex; flex:1; min-height:0; overflow:hidden; }
.sidebar { width:300px; min-width:300px; background:var(--paper); display:flex; flex-direction:column; border-right:1px solid var(--cream); overflow:hidden; z-index:10; }
.sidebar-header { padding:16px 18px 14px; background:var(--white); border-bottom:1px solid var(--cream); flex-shrink:0; }
.sidebar-header h2 { font-family:'Playfair Display',serif; font-size:1rem; font-weight:600; margin-bottom:3px; color:var(--ink); }
.sidebar-header p { font-size:0.72rem; color:var(--slate); }
.listings-list { flex:1; overflow-y:auto; padding:10px; }
.listings-list::-webkit-scrollbar { width:3px; }
.listings-list::-webkit-scrollbar-thumb { background:var(--hunter-light); border-radius:2px; }
.listing-card { background:var(--white); border-radius:var(--radius); margin-bottom:8px; cursor:pointer; border:2px solid transparent; transition:all 0.2s; overflow:hidden; box-shadow:0 2px 6px rgba(28,43,30,0.07); }
.listing-card:hover { border-color:var(--hunter-light); box-shadow:var(--shadow); transform:translateY(-1px); }
.listing-card.active { border-color:var(--hunter); }
.listing-card.hidden { display:none; }
.card-img { height:100px; position:relative; overflow:hidden; background:var(--cream); }
.card-img img { width:100%; height:100%; object-fit:cover; display:block; }
.card-badge { position:absolute; top:8px; left:8px; padding:2px 8px; border-radius:10px; font-size:0.6rem; font-weight:700; letter-spacing:0.06em; text-transform:uppercase; }
.badge-residential { background:var(--hunter); color:var(--white); }
.badge-commercial { background:var(--brass); color:var(--white); }
.card-status { position:absolute; top:8px; right:8px; padding:2px 8px; border-radius:10px; font-size:0.6rem; font-weight:700; letter-spacing:0.04em; text-transform:uppercase; background:rgba(253,251,245,0.93); }
.status-available { color:#2d5e35; } .status-pending { color:#8a6010; } .status-sold { color:#8a2020; }
.card-body { padding:11px 13px; }
.card-price { font-family:'Playfair Display',serif; font-size:1rem; font-weight:700; color:var(--ink); margin-bottom:3px; }
.card-address { font-size:0.7rem; color:var(--slate); margin-bottom:6px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.card-meta { display:flex; gap:10px; font-size:0.68rem; color:var(--slate); }
.comment-pill { display:inline-flex; align-items:center; gap:3px; font-size:0.65rem; color:var(--hunter-mid); font-weight:500; margin-top:6px; background:#eaf2eb; padding:2px 7px; border-radius:8px; border:1px solid #b8d4bb; }
.map-wrap { flex:1; position:relative; overflow:hidden; }
#map { width:100%; height:100%; min-height:400px; }
.detail-panel { position:absolute; right:0; top:0; bottom:0; width:360px; background:var(--white); box-shadow:-6px 0 32px rgba(28,43,30,0.16); display:flex; flex-direction:column; transform:translateX(100%); transition:transform 0.32s cubic-bezier(0.4,0,0.2,1); z-index:400; overflow:hidden; }
.detail-panel.open { transform:translateX(0); }
.panel-close { position:absolute; top:12px; right:12px; width:30px; height:30px; border-radius:50%; border:1px solid rgba(255,255,255,0.5); background:rgba(28,43,30,0.55); color:var(--white); cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:0.9rem; transition:all 0.2s; z-index:2; line-height:1; }
.panel-close:hover { background:var(--ink); }
.panel-img-wrap { height:190px; flex-shrink:0; position:relative; overflow:hidden; background:var(--cream); }
.panel-img-wrap img { width:100%; height:100%; object-fit:cover; display:block; }
.panel-img-overlay { position:absolute; bottom:0; left:0; right:0; padding:14px 18px; background:linear-gradient(transparent,rgba(20,36,22,0.75)); }
.panel-price { font-family:'Playfair Display',serif; font-size:1.5rem; font-weight:700; color:var(--white); }
.panel-body { flex:1; overflow-y:auto; padding:18px 20px 28px; }
.panel-body::-webkit-scrollbar { width:3px; }
.panel-body::-webkit-scrollbar-thumb { background:var(--hunter-light); border-radius:2px; }
.panel-title { font-family:'Playfair Display',serif; font-size:1.05rem; font-weight:600; margin-bottom:3px; color:var(--ink); }
.panel-address { font-size:0.76rem; color:var(--slate); margin-bottom:14px; }
.panel-tags { display:flex; gap:6px; flex-wrap:wrap; margin-bottom:16px; }
.panel-tag { padding:3px 10px; border-radius:12px; font-size:0.67rem; font-weight:500; background:var(--cream); color:var(--slate); }
.panel-tag.type-residential { background:#dff0e2; color:#1e4425; border:1px solid #a8ccad; }
.panel-tag.type-commercial { background:#f5eed8; color:#5a4010; border:1px solid var(--brass-light); }
.panel-tag.tag-available { background:#dff0e2; color:#1e4425; border:1px solid #a8ccad; }
.panel-tag.tag-pending { background:#f5eed8; color:#7a5010; border:1px solid #d4bc7a; }
.panel-tag.tag-sold { background:#f5e0e0; color:#6a1a1a; border:1px solid #d4a0a0; }
.details-grid { display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-bottom:16px; }
.detail-item { background:var(--paper); border-radius:7px; padding:10px 12px; border:1px solid var(--cream); }
.detail-item label { font-size:0.62rem; color:var(--slate); text-transform:uppercase; letter-spacing:0.06em; display:block; margin-bottom:3px; }
.detail-item span { font-size:0.85rem; font-weight:600; color:var(--ink); }
.panel-desc { font-size:0.78rem; color:var(--slate); line-height:1.65; margin-bottom:20px; }
.comments-section { border-top:1px solid var(--cream); padding-top:18px; }
.comments-title { font-family:'Playfair Display',serif; font-size:0.95rem; font-weight:600; color:var(--ink); margin-bottom:14px; display:flex; align-items:center; gap:7px; }
.comments-title .count { background:var(--hunter); color:var(--white); width:20px; height:20px; border-radius:50%; font-family:'DM Sans',sans-serif; font-size:0.67rem; font-weight:700; display:flex; align-items:center; justify-content:center; }
.comment-form { margin-bottom:16px; }
.c-input, .c-textarea { width:100%; border:1px solid var(--cream); border-radius:7px; font-family:'DM Sans',sans-serif; font-size:0.78rem; color:var(--ink); background:var(--paper); transition:border-color 0.2s; display:block; }
.c-input { padding:8px 12px; margin-bottom:7px; }
.c-textarea { padding:9px 12px; resize:vertical; min-height:70px; margin-bottom:9px; }
.c-input:focus, .c-textarea:focus { outline:none; border-color:var(--hunter-mid); }
.c-submit { padding:8px 18px; background:var(--hunter); color:var(--white); border:none; border-radius:7px; font-family:'DM Sans',sans-serif; font-size:0.75rem; font-weight:600; cursor:pointer; letter-spacing:0.03em; transition:all 0.2s; }
.c-submit:hover { background:var(--brass); }
.comments-list { display:flex; flex-direction:column; gap:10px; }
.comment-item { background:var(--paper); border-radius:9px; padding:12px 14px; animation:fadeUp 0.28s ease; border:1px solid var(--cream); }
@keyframes fadeUp { from{opacity:0;transform:translateY(6px)} to{opacity:1;transform:translateY(0)} }
.comment-header { display:flex; align-items:center; gap:9px; margin-bottom:7px; }
.c-avatar { width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:0.7rem; font-weight:700; color:var(--white); flex-shrink:0; }
.c-meta { flex:1; }
.c-name { font-size:0.78rem; font-weight:600; color:var(--ink); }
.c-time { font-size:0.65rem; color:var(--slate); }
.c-text { font-size:0.76rem; color:var(--slate); line-height:1.55; }
.c-del { background:none; border:none; cursor:pointer; color:var(--slate); font-size:0.7rem; opacity:0.4; transition:opacity 0.2s; padding:2px 4px; }
.c-del:hover { opacity:1; color:#8a2020; }
.no-comments { text-align:center; padding:20px; color:var(--slate); font-size:0.75rem; background:var(--paper); border-radius:9px; border:1px dashed var(--cream); }
.leaflet-popup-content-wrapper { border-radius:9px; box-shadow:0 8px 28px rgba(28,43,30,0.18); padding:0; overflow:hidden; }
.leaflet-popup-content { margin:0; }
.popup-inner { padding:12px 14px; min-width:175px; }
.popup-inner strong { font-family:'Playfair Display',serif; font-size:0.95rem; display:block; margin-bottom:2px; color:#1c2b1e; }
.popup-inner small { color:#4a5e4d; font-size:0.7rem; font-family:'DM Sans',sans-serif; }
.popup-btn { display:block; width:100%; margin-top:9px; padding:7px; background:#2d4a32; color:#fdfbf5; border:none; border-radius:6px; font-family:'DM Sans',sans-serif; font-size:0.72rem; font-weight:600; cursor:pointer; transition:background 0.2s; text-align:center; }
.popup-btn:hover { background:#a8893a; }
</style>
</head>
<body>

<div class="toolbar">
  <div class="logo">Proper<span>Tea</span></div>
  <div class="filters">
    <button class="filter-btn active" onclick="setFilter('all',this)">All</button>
    <button class="filter-btn" onclick="setFilter('residential',this)">Residential</button>
    <button class="filter-btn" onclick="setFilter('commercial',this)">Commercial</button>
    <span class="listing-count" id="countLabel"></span>
  </div>
</div>

<div class="app">
  <div class="sidebar">
    <div class="sidebar-header">
      <h2>Available Properties</h2>
      <p>Click a listing or pin to view details &amp; comments</p>
    </div>
    <div class="listings-list" id="listingsList"></div>
  </div>
  <div class="map-wrap">
    <div id="map"></div>
    <div class="detail-panel" id="detailPanel">
      <button class="panel-close" onclick="closePanel()">&#x2715;</button>
      <div class="panel-img-wrap">
        <img id="pImg" src="" alt="">
        <div class="panel-img-overlay"><div class="panel-price" id="pPrice"></div></div>
      </div>
      <div class="panel-body">
        <div class="panel-title" id="pTitle"></div>
        <div class="panel-address" id="pAddr"></div>
        <div class="panel-tags" id="pTags"></div>
        <div class="details-grid" id="pGrid"></div>
        <div class="panel-desc" id="pDesc"></div>
        <div class="comments-section">
          <div class="comments-title">Comments <span class="count" id="cCount">0</span></div>
          <div class="comment-form">
            <input type="text" class="c-input" id="cName" placeholder="Your name">
            <textarea class="c-textarea" id="cText" placeholder="Share your thoughts on this property…"></textarea>
            <button class="c-submit" onclick="addComment()">Post Comment</button>
          </div>
          <div class="comments-list" id="cList"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
var listings=[
  {id:1,type:'residential',status:'available',price:'$1,250,000',title:'Sunlit Family Home',address:'142 Maple Grove Dr, Los Angeles, CA',beds:4,baths:3,sqft:'2,840',year:2003,desc:'A beautifully maintained colonial-style home with open-plan kitchen, hardwood floors, and a landscaped rear garden. Located in a top-rated school district with easy freeway access.',img:'https://images.unsplash.com/photo-1568605114967-8130f3a36994?w=800&q=80',lat:34.052,lng:-118.243,comments:[]},
  {id:2,type:'commercial',status:'available',price:'$3,800,000',title:'Downtown Office Tower',address:'88 Financial Plaza, Los Angeles, CA',floors:8,units:24,sqft:'18,500',year:1998,desc:'A premium Class-A office building in the heart of the financial district. Fully leased with stable long-term tenants. Excellent cap rate and strong rental growth potential.',img:'https://images.unsplash.com/photo-1486325212027-8081e485255e?w=800&q=80',lat:34.048,lng:-118.256,comments:[]},
  {id:3,type:'residential',status:'pending',price:'$875,000',title:'Modern Hillside Retreat',address:'9 Canyon View Terrace, Pasadena, CA',beds:3,baths:2,sqft:'1,920',year:2017,desc:"A sleek contemporary home perched on a quiet hillside with sweeping valley views. Floor-to-ceiling windows, a rooftop deck, and a chef's kitchen make this a rare find.",img:'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?w=800&q=80',lat:34.063,lng:-118.230,comments:[{id:'c1',author:'Sarah M.',text:'Visited last weekend — the views are absolutely stunning. Hoping our offer goes through!',time:'2 days ago',color:'#2d4a32'}]},
  {id:4,type:'commercial',status:'available',price:'$1,100,000',title:'Retail Strip Mall',address:'410 Sunset Blvd, West Hollywood, CA',floors:1,units:6,sqft:'7,200',year:2005,desc:'A well-positioned retail strip along a high-traffic corridor. Six units, four currently tenanted. Ideal for investors seeking value-add opportunities in a growing submarket.',img:'https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=800&q=80',lat:34.090,lng:-118.370,comments:[]},
  {id:5,type:'residential',status:'available',price:'$2,450,000',title:'Luxury Beach Bungalow',address:'7 Shoreline Walk, Santa Monica, CA',beds:5,baths:4,sqft:'3,600',year:2020,desc:'Steps from the sand, this newly built coastal retreat offers five bedrooms, a private pool, and panoramic ocean views from every room. The pinnacle of Southern California living.',img:'https://images.unsplash.com/photo-1499793983690-e29da59ef1c2?w=800&q=80',lat:34.010,lng:-118.497,comments:[{id:'c2',author:'James T.',text:'Is the price negotiable? Would love to discuss further.',time:'5 hours ago',color:'#a8893a'},{id:'c3',author:'Agent Rivera',text:"Hi James — seller has some flexibility. Let's schedule a viewing this week!",time:'3 hours ago',color:'#3d6644'}]},
  {id:6,type:'commercial',status:'sold',price:'$6,200,000',title:'Mixed-Use Development Site',address:'200 Industrial Way, Culver City, CA',floors:4,units:0,sqft:'32,000',year:1985,desc:'Rare large-format mixed-use development site with approved plans for ground-floor retail and 42 residential units above. Zoned for high-density redevelopment.',img:'https://images.unsplash.com/photo-1554435493-93422e8220c8?w=800&q=80',lat:34.021,lng:-118.397,comments:[]}
];

var activeFilter='all',activeId=null,markers={},map;
var avatarColors=['#2d4a32','#a8893a','#3d6644','#5a4a2a','#4a6e50','#7a6030'];

document.addEventListener('DOMContentLoaded',function(){ initApp(); });

function initApp(){
  map=L.map('map',{preferCanvas:true}).setView([34.052,-118.340],11);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19}).addTo(map);
  setTimeout(function(){ map.invalidateSize(); },300);
  listings.forEach(function(l){
    var m=L.marker([l.lat,l.lng],{icon:mkIcon(l,false)});
    m.bindPopup(L.popup({closeButton:false,maxWidth:220}).setContent('<div class="popup-inner"><strong>'+esc(l.title)+'</strong><small>'+esc(l.address)+'</small><button class="popup-btn" onclick="openListing('+l.id+')">View Details &amp; Comments</button></div>'));
    m.on('click',function(){ resetIcons(); markers[l.id].setIcon(mkIcon(l,true)); });
    m.addTo(map); markers[l.id]=m;
  });
  renderSidebar();
}

function mkIcon(l,sel){
  var bg=sel?'#a8893a':'#2d4a32',fg='#fdfbf5',bd=l.type==='residential'?'#4e7d56':'#a8893a';
  return L.divIcon({html:'<div style="background:'+bg+';color:'+fg+';padding:5px 10px;border-radius:18px;font-size:10px;font-weight:700;white-space:nowrap;cursor:pointer;font-family:DM Sans,sans-serif;box-shadow:0 3px 10px rgba(28,43,30,.4);border:2px solid '+bd+';position:relative;">'+l.price+'<div style="position:absolute;bottom:-8px;left:50%;transform:translateX(-50%);border:6px solid transparent;border-top-color:'+bg+';border-bottom:none;"></div></div>',className:'',iconAnchor:[46,34],popupAnchor:[0,-38]});
}

function resetIcons(){ listings.forEach(function(l){ if(markers[l.id]) markers[l.id].setIcon(mkIcon(l,false)); }); }

function renderSidebar(){
  var filtered=listings.filter(function(l){ return activeFilter==='all'||l.type===activeFilter; });
  document.getElementById('countLabel').textContent=filtered.length+' listing'+(filtered.length!==1?'s':'');
  var container=document.getElementById('listingsList');
  container.innerHTML='';
  listings.forEach(function(l){
    var vis=activeFilter==='all'||l.type===activeFilter;
    var el=document.createElement('div');
    el.className='listing-card'+(l.id===activeId?' active':'')+(vis?'':' hidden');
    el.dataset.id=l.id;
    var meta=l.type==='residential'?'<span>&#x1F6CF; '+l.beds+' bed</span><span>&#x1F6C1; '+l.baths+' bath</span><span>'+l.sqft+' sqft</span>':'<span>&#x1F3E2; '+l.floors+' fl</span><span>'+l.sqft+' sqft</span>';
    var cc=l.comments.length;
    el.innerHTML='<div class="card-img"><img src="'+l.img+'" loading="lazy" alt="'+esc(l.title)+'"><span class="card-badge badge-'+l.type+'">'+l.type+'</span><span class="card-status status-'+l.status+'">'+l.status+'</span></div><div class="card-body"><div class="card-price">'+l.price+'</div><div class="card-address">'+esc(l.address)+'</div><div class="card-meta">'+meta+'</div>'+(cc>0?'<div class="comment-pill">&#x1F4AC; '+cc+' comment'+(cc!==1?'s':'')+'</div>':'')+'</div>';
    el.addEventListener('click',function(){ openListing(l.id); });
    container.appendChild(el);
  });
}

function setFilter(type,btn){
  activeFilter=type;
  document.querySelectorAll('.filter-btn').forEach(function(b){ b.classList.remove('active'); });
  btn.classList.add('active');
  listings.forEach(function(l){ var m=markers[l.id]; if(!m) return; if(type==='all'||l.type===type) m.addTo(map); else map.removeLayer(m); });
  renderSidebar();
}

function openListing(id){
  activeId=id;
  var l=listings.find(function(x){ return x.id===id; });
  if(!l) return;
  document.querySelectorAll('.listing-card').forEach(function(c){ c.classList.toggle('active',+c.dataset.id===id); });
  map.flyTo([l.lat,l.lng],14,{duration:1});
  resetIcons(); markers[id].setIcon(mkIcon(l,true)); markers[id].openPopup();
  document.getElementById('pImg').src=l.img;
  document.getElementById('pPrice').textContent=l.price;
  document.getElementById('pTitle').textContent=l.title;
  document.getElementById('pAddr').textContent=l.address;
  document.getElementById('pTags').innerHTML='<span class="panel-tag type-'+l.type+'">'+l.type.charAt(0).toUpperCase()+l.type.slice(1)+'</span><span class="panel-tag tag-'+l.status+'">'+l.status.charAt(0).toUpperCase()+l.status.slice(1)+'</span><span class="panel-tag">Built '+l.year+'</span>';
  document.getElementById('pGrid').innerHTML=l.type==='residential'?dItem('Bedrooms',l.beds)+dItem('Bathrooms',l.baths)+dItem('Square Feet',l.sqft)+dItem('Year Built',l.year):dItem('Floors',l.floors)+dItem('Square Feet',l.sqft)+dItem('Units',l.units||'—')+dItem('Year Built',l.year);
  document.getElementById('pDesc').textContent=l.desc;
  renderComments(l);
  document.getElementById('detailPanel').classList.add('open');
}

function dItem(l,v){ return '<div class="detail-item"><label>'+l+'</label><span>'+v+'</span></div>'; }

function closePanel(){
  document.getElementById('detailPanel').classList.remove('open');
  activeId=null;
  document.querySelectorAll('.listing-card').forEach(function(c){ c.classList.remove('active'); });
  resetIcons(); map.closePopup();
}

function renderComments(l){
  document.getElementById('cCount').textContent=l.comments.length;
  var list=document.getElementById('cList');
  if(!l.comments.length){ list.innerHTML='<div class="no-comments"><div style="font-size:1.4rem;margin-bottom:6px">&#x1F4AC;</div>No comments yet — be the first!</div>'; return; }
  list.innerHTML=l.comments.map(function(c,i){ var col=c.color||avatarColors[i%avatarColors.length]; return '<div class="comment-item"><div class="comment-header"><div class="c-avatar" style="background:'+col+'">'+esc(c.author.charAt(0).toUpperCase())+'</div><div class="c-meta"><div class="c-name">'+esc(c.author)+'</div><div class="c-time">'+c.time+'</div></div><button class="c-del" onclick="delComment('+l.id+',\''+c.id+'\')">&#x2715;</button></div><div class="c-text">'+esc(c.text)+'</div></div>'; }).join('');
  renderSidebar();
}

function addComment(){
  if(!activeId) return;
  var l=listings.find(function(x){ return x.id===activeId; });
  var name=document.getElementById('cName').value.trim();
  var text=document.getElementById('cText').value.trim();
  if(!name||!text){ alert('Please enter your name and a comment.'); return; }
  l.comments.push({id:'c'+Date.now(),author:name,text:text,time:'Just now',color:avatarColors[l.comments.length%avatarColors.length]});
  document.getElementById('cName').value=''; document.getElementById('cText').value='';
  renderComments(l);
}

function delComment(lid,cid){
  var l=listings.find(function(x){ return x.id===lid; });
  l.comments=l.comments.filter(function(c){ return c.id!==cid; });
  renderComments(l);
}

function esc(s){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

window.addEventListener('resize',function(){ if(map) setTimeout(function(){ map.invalidateSize(); },100); });
window.addEventListener('load',function(){ if(map) setTimeout(function(){ map.invalidateSize(); },200); });
</script>
</body>
</html>
