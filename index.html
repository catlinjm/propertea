<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ProperTea â€” Find Your Perfect Property</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css"/>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
<style>
*, *::before, *::after { box-sizing:border-box; margin:0; padding:0; }
:root {
  --ink:#1c2b1e; --hunter:#2d4a32; --hunter-mid:#3d6644; --hunter-light:#4e7d56;
  --paper:#f5f2ea; --cream:#e8e3d5; --brass:#a8893a; --brass-light:#d4bc7a;
  --slate:#4a5e4d; --white:#fdfbf5; --overlay:rgba(20,36,22,0.62);
  --shadow:0 4px 24px rgba(28,43,30,0.14); --shadow-lg:0 12px 48px rgba(28,43,30,0.2);
  --radius:10px;
}
html { scroll-behavior:smooth; }
body { font-family:'DM Sans',sans-serif; background:var(--paper); color:var(--ink); min-height:100vh; }

/* â”€â”€ NAV â”€â”€ */
nav {
  position:fixed; top:0; left:0; right:0; z-index:1000;
  height:60px; display:flex; align-items:center; justify-content:space-between;
  padding:0 40px;
  background:rgba(28,43,30,0.96);
  backdrop-filter:blur(12px);
  border-bottom:1px solid rgba(168,137,58,0.2);
}
.nav-logo { display:flex; align-items:center; gap:10px; text-decoration:none; }
.nav-logo svg { width:32px; height:32px; }
.nav-logo-text { font-family:'Playfair Display',serif; font-size:1.3rem; font-weight:700; color:var(--brass-light); letter-spacing:0.02em; }
.nav-logo-text span { color:rgba(245,242,234,0.8); font-weight:400; }
.nav-links { display:flex; gap:28px; align-items:center; }
.nav-links a { color:rgba(245,242,234,0.65); font-size:0.82rem; text-decoration:none; font-weight:500; letter-spacing:0.03em; transition:color 0.2s; }
.nav-links a:hover { color:var(--brass-light); }
.nav-cta { padding:7px 18px; background:var(--brass); color:var(--white); border:none; border-radius:20px; font-family:'DM Sans',sans-serif; font-size:0.78rem; font-weight:600; cursor:pointer; transition:all 0.2s; text-decoration:none; letter-spacing:0.03em; }
.nav-cta:hover { background:var(--brass-light); color:var(--ink); }

/* â”€â”€ HERO â”€â”€ */
.hero {
  position:relative; height:88vh; min-height:560px;
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  overflow:hidden; padding-top:60px;
}
.hero-bg {
  position:absolute; inset:0; z-index:0;
  background: linear-gradient(160deg, #1c2b1e 0%, #2d4a32 40%, #3d6644 70%, #1c2b1e 100%);
}
.hero-bg::after {
  content:'';
  position:absolute; inset:0;
  background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23a8893a' fill-opacity='0.04'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
}
/* Decorative leaf shapes */
.hero-leaf { position:absolute; opacity:0.06; pointer-events:none; }
.hero-leaf-1 { top:-60px; right:-40px; width:420px; height:420px; }
.hero-leaf-2 { bottom:-80px; left:-60px; width:340px; height:340px; transform:rotate(180deg); }

.hero-content { position:relative; z-index:2; text-align:center; padding:0 20px; max-width:780px; }
.hero-eyebrow {
  display:inline-flex; align-items:center; gap:8px;
  background:rgba(168,137,58,0.18); border:1px solid rgba(168,137,58,0.35);
  padding:5px 14px; border-radius:20px;
  font-size:0.72rem; color:var(--brass-light); letter-spacing:0.08em; text-transform:uppercase;
  margin-bottom:20px; animation:fadeDown 0.6s ease both;
}
.hero-title {
  font-family:'Playfair Display',serif;
  font-size:clamp(2.4rem, 5vw, 4rem);
  font-weight:700; color:var(--white);
  line-height:1.15; margin-bottom:14px;
  animation:fadeDown 0.6s 0.1s ease both;
}
.hero-title em { color:var(--brass-light); font-style:italic; }
.hero-sub {
  font-size:1rem; color:rgba(245,242,234,0.6);
  margin-bottom:36px; line-height:1.6;
  animation:fadeDown 0.6s 0.2s ease both;
}

/* â”€â”€ SEARCH BAR â”€â”€ */
.search-wrap {
  animation:fadeDown 0.6s 0.3s ease both;
  width:100%; max-width:640px; margin:0 auto;
}
.search-bar {
  display:flex; align-items:center;
  background:var(--white); border-radius:50px;
  box-shadow:0 8px 40px rgba(0,0,0,0.25);
  overflow:hidden; border:2px solid transparent;
  transition:border-color 0.2s;
}
.search-bar:focus-within { border-color:var(--brass-light); }
.search-icon { padding:0 16px 0 20px; color:var(--slate); font-size:1.1rem; flex-shrink:0; }
.search-input {
  flex:1; padding:16px 8px; border:none; outline:none;
  font-family:'DM Sans',sans-serif; font-size:0.95rem;
  color:var(--ink); background:transparent;
}
.search-input::placeholder { color:#a0a8a2; }
.search-btn {
  margin:6px; padding:10px 24px;
  background:var(--hunter); color:var(--white);
  border:none; border-radius:40px;
  font-family:'DM Sans',sans-serif; font-size:0.85rem; font-weight:600;
  cursor:pointer; transition:all 0.2s; white-space:nowrap;
  letter-spacing:0.03em;
}
.search-btn:hover { background:var(--brass); }
.search-suggestions {
  position:absolute; top:calc(100% + 6px); left:0; right:0;
  background:var(--white); border-radius:12px;
  box-shadow:var(--shadow-lg); overflow:hidden;
  display:none; z-index:100;
}
.search-suggestions.show { display:block; }
.suggestion-item {
  padding:10px 20px; font-size:0.83rem; color:var(--ink);
  cursor:pointer; transition:background 0.15s;
  display:flex; align-items:center; gap:10px;
}
.suggestion-item:hover { background:var(--paper); }
.suggestion-item span { color:var(--slate); font-size:0.75rem; }
.search-wrap-inner { position:relative; }

@keyframes fadeDown { from{opacity:0;transform:translateY(-16px)} to{opacity:1;transform:translateY(0)} }

/* â”€â”€ STATS BAR â”€â”€ */
.stats-bar {
  position:absolute; bottom:0; left:0; right:0; z-index:2;
  background:rgba(20,36,22,0.85); backdrop-filter:blur(8px);
  border-top:1px solid rgba(168,137,58,0.2);
  display:flex; justify-content:center; gap:0;
}
.stat-item {
  padding:14px 40px; text-align:center;
  border-right:1px solid rgba(168,137,58,0.15);
}
.stat-item:last-child { border-right:none; }
.stat-num { font-family:'Playfair Display',serif; font-size:1.3rem; font-weight:700; color:var(--brass-light); }
.stat-label { font-size:0.68rem; color:rgba(245,242,234,0.45); text-transform:uppercase; letter-spacing:0.06em; margin-top:2px; }

/* â”€â”€ SECTION COMMON â”€â”€ */
section { padding:72px 40px; }
.section-eyebrow { font-size:0.72rem; color:var(--brass); text-transform:uppercase; letter-spacing:0.1em; font-weight:600; margin-bottom:8px; }
.section-title { font-family:'Playfair Display',serif; font-size:1.9rem; font-weight:700; color:var(--ink); margin-bottom:6px; }
.section-sub { font-size:0.85rem; color:var(--slate); margin-bottom:32px; }

/* â”€â”€ FEATURED LISTINGS â”€â”€ */
.featured-section { background:var(--white); }
.featured-header { display:flex; justify-content:space-between; align-items:flex-end; margin-bottom:28px; }
.view-all-btn { padding:8px 20px; border:1.5px solid var(--hunter); color:var(--hunter); background:transparent; border-radius:20px; font-family:'DM Sans',sans-serif; font-size:0.78rem; font-weight:600; cursor:pointer; transition:all 0.2s; letter-spacing:0.03em; }
.view-all-btn:hover { background:var(--hunter); color:var(--white); }

.carousel-wrap { position:relative; }
.carousel { display:flex; gap:20px; overflow-x:auto; scroll-snap-type:x mandatory; padding-bottom:8px; scrollbar-width:none; }
.carousel::-webkit-scrollbar { display:none; }
.carousel-arrow {
  position:absolute; top:50%; transform:translateY(-50%);
  width:38px; height:38px; border-radius:50%;
  background:var(--white); border:1.5px solid var(--cream);
  box-shadow:var(--shadow); cursor:pointer;
  display:flex; align-items:center; justify-content:center;
  font-size:0.9rem; color:var(--ink); transition:all 0.2s; z-index:5;
}
.carousel-arrow:hover { background:var(--hunter); color:var(--white); border-color:var(--hunter); }
.carousel-arrow.prev { left:-18px; }
.carousel-arrow.next { right:-18px; }

/* â”€â”€ LISTING CARD â”€â”€ */
.feat-card {
  flex:0 0 280px; scroll-snap-align:start;
  background:var(--paper); border-radius:14px;
  overflow:hidden; cursor:pointer;
  border:2px solid transparent;
  transition:all 0.25s; box-shadow:0 2px 12px rgba(28,43,30,0.08);
}
.feat-card:hover { border-color:var(--hunter-light); transform:translateY(-3px); box-shadow:var(--shadow-lg); }
.feat-card-img { height:170px; position:relative; overflow:hidden; background:var(--cream); }
.feat-card-img img { width:100%; height:100%; object-fit:cover; display:block; transition:transform 0.4s; }
.feat-card:hover .feat-card-img img { transform:scale(1.04); }
.feat-card-img .no-photo { width:100%; height:100%; display:flex; align-items:center; justify-content:center; font-size:2.5rem; color:var(--slate); opacity:0.3; }
.feat-badge { position:absolute; top:10px; left:10px; padding:3px 10px; border-radius:12px; font-size:0.62rem; font-weight:700; letter-spacing:0.06em; text-transform:uppercase; }
.feat-badge.residential { background:var(--hunter); color:var(--white); }
.feat-badge.commercial { background:var(--brass); color:var(--white); }
.feat-status { position:absolute; top:10px; right:10px; padding:3px 10px; border-radius:12px; font-size:0.62rem; font-weight:700; background:rgba(253,251,245,0.93); }
.feat-status.active { color:#2d5e35; }
.feat-status.pending { color:#8a6010; }
.feat-hot { position:absolute; bottom:10px; left:10px; padding:3px 10px; border-radius:12px; font-size:0.62rem; font-weight:700; background:rgba(168,137,58,0.9); color:var(--white); display:flex; align-items:center; gap:4px; }

.feat-card-body { padding:14px 16px; }
.feat-price { font-family:'Playfair Display',serif; font-size:1.15rem; font-weight:700; color:var(--ink); margin-bottom:3px; }
.feat-title { font-size:0.78rem; font-weight:600; color:var(--hunter-mid); margin-bottom:3px; }
.feat-addr { font-size:0.72rem; color:var(--slate); margin-bottom:10px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.feat-meta { display:flex; gap:12px; font-size:0.7rem; color:var(--slate); padding-top:10px; border-top:1px solid var(--cream); }
.feat-comments { display:flex; align-items:center; gap:4px; margin-top:8px; font-size:0.68rem; color:var(--hunter-mid); font-weight:500; }

/* Loading skeleton */
.skel-card { flex:0 0 280px; background:var(--cream); border-radius:14px; height:280px; overflow:hidden; position:relative; }
.skel-card::after { content:''; position:absolute; inset:0; background:linear-gradient(90deg,transparent 0%,rgba(255,255,255,0.4) 50%,transparent 100%); animation:shimmer 1.4s infinite; }
@keyframes shimmer { from{transform:translateX(-100%)} to{transform:translateX(100%)} }

/* â”€â”€ MAP SECTION â”€â”€ */
.map-section { background:var(--paper); padding:72px 40px; }
.map-container {
  border-radius:16px; overflow:hidden;
  box-shadow:var(--shadow-lg);
  height:560px; position:relative;
  border:1px solid var(--cream);
}
#map { width:100%; height:100%; }

/* Map overlay search */
.map-search-bar {
  position:absolute; top:16px; left:50%; transform:translateX(-50%);
  z-index:500; width:420px; max-width:90%;
  display:flex; gap:0;
  background:var(--white); border-radius:40px;
  box-shadow:0 4px 20px rgba(28,43,30,0.2);
  border:1.5px solid var(--cream);
  overflow:hidden; transition:border-color 0.2s;
}
.map-search-bar:focus-within { border-color:var(--brass-light); }
.map-search-input {
  flex:1; padding:11px 16px; border:none; outline:none;
  font-family:'DM Sans',sans-serif; font-size:0.83rem;
  color:var(--ink); background:transparent;
}
.map-search-input::placeholder { color:#a0a8a2; }
.map-search-btn {
  padding:10px 18px; background:var(--hunter); color:var(--white);
  border:none; font-family:'DM Sans',sans-serif; font-size:0.78rem;
  font-weight:600; cursor:pointer; transition:background 0.2s; white-space:nowrap;
}
.map-search-btn:hover { background:var(--brass); }

.map-legend {
  position:absolute; bottom:16px; left:16px; z-index:500;
  background:rgba(253,251,245,0.95); border-radius:10px;
  padding:10px 14px; font-size:0.72rem; color:var(--ink);
  box-shadow:var(--shadow); border:1px solid var(--cream);
}
.legend-item { display:flex; align-items:center; gap:7px; margin-bottom:5px; }
.legend-item:last-child { margin-bottom:0; }
.legend-dot { width:10px; height:10px; border-radius:50%; }

/* Loading / error states */
.map-status {
  position:absolute; top:64px; left:50%; transform:translateX(-50%);
  z-index:500; background:rgba(28,43,30,0.92);
  color:var(--white); border-radius:8px; padding:9px 18px;
  font-size:0.76rem; display:none; align-items:center; gap:8px;
  max-width:80%; text-align:center; line-height:1.45;
}
.map-status.show { display:flex; }
.mini-spinner { width:14px; height:14px; border:2px solid rgba(255,255,255,0.3); border-top-color:var(--brass-light); border-radius:50%; animation:spin 0.8s linear infinite; flex-shrink:0; }
@keyframes spin { to{transform:rotate(360deg)} }

/* â”€â”€ DETAIL PANEL (slides over map) â”€â”€ */
.detail-panel {
  position:absolute; right:0; top:0; bottom:0; width:360px;
  background:var(--white); box-shadow:-6px 0 32px rgba(28,43,30,0.16);
  display:flex; flex-direction:column;
  transform:translateX(100%); transition:transform 0.32s cubic-bezier(0.4,0,0.2,1);
  z-index:600; overflow:hidden; border-radius:0 16px 16px 0;
}
.detail-panel.open { transform:translateX(0); }
.panel-close { position:absolute; top:12px; right:12px; width:30px; height:30px; border-radius:50%; border:1px solid rgba(255,255,255,0.5); background:rgba(28,43,30,0.55); color:var(--white); cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:0.9rem; transition:all 0.2s; z-index:2; }
.panel-close:hover { background:var(--ink); }
.panel-img-wrap { height:190px; flex-shrink:0; position:relative; overflow:hidden; background:var(--cream); }
.panel-img-wrap img { width:100%; height:100%; object-fit:cover; display:block; }
.panel-img-wrap .no-photo-lg { width:100%; height:100%; display:flex; align-items:center; justify-content:center; font-size:3rem; opacity:0.3; }
.panel-img-overlay { position:absolute; bottom:0; left:0; right:0; padding:14px 18px; background:linear-gradient(transparent,rgba(20,36,22,0.75)); }
.panel-price { font-family:'Playfair Display',serif; font-size:1.4rem; font-weight:700; color:var(--white); }
.panel-body { flex:1; overflow-y:auto; padding:16px 18px 24px; }
.panel-body::-webkit-scrollbar { width:3px; }
.panel-body::-webkit-scrollbar-thumb { background:var(--hunter-light); border-radius:2px; }
.panel-title { font-family:'Playfair Display',serif; font-size:1rem; font-weight:600; margin-bottom:3px; color:var(--ink); }
.panel-address { font-size:0.74rem; color:var(--slate); margin-bottom:12px; }
.panel-tags { display:flex; gap:5px; flex-wrap:wrap; margin-bottom:12px; }
.panel-tag { padding:3px 9px; border-radius:10px; font-size:0.65rem; font-weight:500; background:var(--cream); color:var(--slate); }
.panel-tag.type-residential { background:#dff0e2; color:#1e4425; border:1px solid #a8ccad; }
.panel-tag.type-commercial { background:#f5eed8; color:#5a4010; border:1px solid var(--brass-light); }
.panel-tag.tag-active { background:#dff0e2; color:#1e4425; border:1px solid #a8ccad; }
.panel-tag.tag-pending { background:#f5eed8; color:#7a5010; border:1px solid #d4bc7a; }
.details-grid { display:grid; grid-template-columns:1fr 1fr; gap:7px; margin-bottom:14px; }
.detail-item { background:var(--paper); border-radius:7px; padding:9px 11px; border:1px solid var(--cream); }
.detail-item label { font-size:0.6rem; color:var(--slate); text-transform:uppercase; letter-spacing:0.06em; display:block; margin-bottom:2px; }
.detail-item span { font-size:0.82rem; font-weight:600; color:var(--ink); }
.panel-desc { font-size:0.76rem; color:var(--slate); line-height:1.6; margin-bottom:18px; }
.mls-badge { display:inline-flex; align-items:center; gap:5px; font-size:0.63rem; color:var(--slate); background:var(--paper); border:1px solid var(--cream); border-radius:6px; padding:3px 8px; margin-bottom:14px; }
.mls-badge strong { color:var(--hunter); }

/* Comments */
.comments-section { border-top:1px solid var(--cream); padding-top:16px; }
.comments-title { font-family:'Playfair Display',serif; font-size:0.9rem; font-weight:600; color:var(--ink); margin-bottom:12px; display:flex; align-items:center; gap:6px; }
.comments-title .count { background:var(--hunter); color:var(--white); width:19px; height:19px; border-radius:50%; font-family:'DM Sans',sans-serif; font-size:0.65rem; font-weight:700; display:flex; align-items:center; justify-content:center; }
.comment-form { margin-bottom:14px; }
.c-input,.c-textarea { width:100%; border:1px solid var(--cream); border-radius:7px; font-family:'DM Sans',sans-serif; font-size:0.76rem; color:var(--ink); background:var(--paper); transition:border-color 0.2s; display:block; }
.c-input { padding:7px 11px; margin-bottom:6px; }
.c-textarea { padding:8px 11px; resize:vertical; min-height:60px; margin-bottom:8px; }
.c-input:focus,.c-textarea:focus { outline:none; border-color:var(--hunter-mid); }
.c-submit { padding:7px 16px; background:var(--hunter); color:var(--white); border:none; border-radius:7px; font-family:'DM Sans',sans-serif; font-size:0.73rem; font-weight:600; cursor:pointer; transition:all 0.2s; }
.c-submit:hover { background:var(--brass); }
.comments-list { display:flex; flex-direction:column; gap:8px; }
.comment-item { background:var(--paper); border-radius:8px; padding:10px 12px; animation:fadeUp 0.25s ease; border:1px solid var(--cream); }
@keyframes fadeUp { from{opacity:0;transform:translateY(5px)} to{opacity:1;transform:translateY(0)} }
.comment-header { display:flex; align-items:center; gap:8px; margin-bottom:6px; }
.c-avatar { width:26px; height:26px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:0.65rem; font-weight:700; color:var(--white); flex-shrink:0; }
.c-meta { flex:1; }
.c-name { font-size:0.74rem; font-weight:600; color:var(--ink); }
.c-time { font-size:0.63rem; color:var(--slate); }
.c-text { font-size:0.73rem; color:var(--slate); line-height:1.5; }
.c-del { background:none; border:none; cursor:pointer; color:var(--slate); font-size:0.68rem; opacity:0.4; transition:opacity 0.2s; padding:2px; }
.c-del:hover { opacity:1; color:#8a2020; }
.no-comments { text-align:center; padding:16px; color:var(--slate); font-size:0.73rem; background:var(--paper); border-radius:8px; border:1px dashed var(--cream); }

/* â”€â”€ FOOTER â”€â”€ */
footer {
  background:var(--ink); color:rgba(245,242,234,0.5);
  padding:32px 40px; text-align:center;
  font-size:0.75rem; border-top:1px solid rgba(168,137,58,0.15);
}
footer strong { color:var(--brass-light); }

/* Leaflet popup */
.leaflet-popup-content-wrapper { border-radius:9px; box-shadow:0 8px 28px rgba(28,43,30,0.18); padding:0; overflow:hidden; }
.leaflet-popup-content { margin:0; }
.popup-inner { padding:12px 14px; min-width:175px; }
.popup-inner strong { font-family:'Playfair Display',serif; font-size:0.92rem; display:block; margin-bottom:2px; color:#1c2b1e; }
.popup-inner small { color:#4a5e4d; font-size:0.7rem; font-family:'DM Sans',sans-serif; }
.popup-btn { display:block; width:100%; margin-top:9px; padding:7px; background:#2d4a32; color:#fdfbf5; border:none; border-radius:6px; font-family:'DM Sans',sans-serif; font-size:0.72rem; font-weight:600; cursor:pointer; transition:background 0.2s; text-align:center; }
.popup-btn:hover { background:#a8893a; }

/* Boundary layer style */
.city-boundary { fill:rgba(168,137,58,0.06); stroke:#a8893a; stroke-width:2; stroke-dasharray:6,4; }
</style>
</head>
<body>

<!-- NAV -->
<nav>
  <a href="#" class="nav-logo">
    <!-- Leaf SVG matching the logo -->
    <svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M20 36C20 36 6 28 6 16C6 9 12 4 20 4C28 4 34 9 34 16C34 28 20 36 20 36Z" fill="#d4bc7a" opacity="0.9"/>
      <path d="M20 36C20 36 6 28 6 16C6 9 12 4 20 4" fill="none" stroke="#a8893a" stroke-width="1.5"/>
      <path d="M20 10 C20 10 14 18 14 24" stroke="#2d4a32" stroke-width="1.2" stroke-linecap="round"/>
      <path d="M20 10 C20 10 26 18 26 24" stroke="#2d4a32" stroke-width="1.2" stroke-linecap="round"/>
      <path d="M20 10 L20 34" stroke="#2d4a32" stroke-width="1.4" stroke-linecap="round"/>
    </svg>
    <span class="nav-logo-text">Proper<span>Tea</span></span>
  </a>
  <div class="nav-links">
    <a href="#featured">Featured</a>
    <a href="#map-section">Map Search</a>
    <a href="#" class="nav-cta">List a Property</a>
  </div>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="hero-bg">
    <svg class="hero-leaf hero-leaf-1" viewBox="0 0 200 200" fill="none"><path d="M100 180C100 180 20 140 20 80C20 40 55 10 100 10C145 10 180 40 180 80C180 140 100 180 100 180Z" fill="#d4bc7a"/></svg>
    <svg class="hero-leaf hero-leaf-2" viewBox="0 0 200 200" fill="none"><path d="M100 180C100 180 20 140 20 80C20 40 55 10 100 10C145 10 180 40 180 80C180 140 100 180 100 180Z" fill="#d4bc7a"/></svg>
  </div>

  <div class="hero-content">
    <div class="hero-eyebrow">ğŸƒ Live MLS Data Â· Updated Daily</div>
    <h1 class="hero-title">Find Your Perfect<br><em>Property</em></h1>
    <p class="hero-sub">Search active listings across your city â€” with real-time MLS data, interactive maps, and community insights.</p>

    <div class="search-wrap">
      <div class="search-wrap-inner">
        <div class="search-bar">
          <div class="search-icon">ğŸ”</div>
          <input type="text" class="search-input" id="heroSearch" placeholder="Enter a city, neighborhood, or ZIP codeâ€¦" autocomplete="off">
          <button class="search-btn" onclick="heroSearchGo()">Search</button>
        </div>
        <div class="search-suggestions" id="heroSuggestions"></div>
      </div>
    </div>
  </div>

  <div class="stats-bar">
    <div class="stat-item"><div class="stat-num" id="statComments">â€”</div><div class="stat-label">ğŸ’¬ Comments This Week</div></div>
    <div class="stat-item"><div class="stat-num" id="statHot">â€”</div><div class="stat-label">ğŸ”¥ Listings Being Talked About</div></div>
    <div class="stat-item"><div class="stat-num" id="statNosy">â€”</div><div class="stat-label">ğŸ‘€ Nosy Neighbours Online</div></div>
    <div class="stat-item"><div class="stat-num" id="statTea">â€”</div><div class="stat-label">ğŸµ Cups of Tea Spilled</div></div>
  </div>
</section>

<!-- FEATURED LISTINGS -->
<section class="featured-section" id="featured">
  <div class="featured-header">
    <div>
      <div class="section-eyebrow">ğŸ¡ Hot Listings</div>
      <div class="section-title">Featured Properties</div>
      <div class="section-sub">Most-commented listings from the MLS this week</div>
    </div>
    <button class="view-all-btn" onclick="scrollToMap()">View All on Map â†“</button>
  </div>
  <div class="carousel-wrap">
    <button class="carousel-arrow prev" onclick="scrollCarousel(-1)">&#8592;</button>
    <div class="carousel" id="featuredCarousel"></div>
    <button class="carousel-arrow next" onclick="scrollCarousel(1)">&#8594;</button>
  </div>
</section>

<!-- MAP SEARCH SECTION -->
<section class="map-section" id="map-section">
  <div>
    <div class="section-eyebrow">ğŸ“ Explore the Map</div>
    <div class="section-title">Search by City</div>
    <div class="section-sub">Enter any city to load listings within its boundaries and see them on the map</div>
  </div>
  <div class="map-container">
    <div class="map-search-bar">
      <input type="text" class="map-search-input" id="mapCityInput" placeholder="ğŸ™  Enter city (e.g. Houston, TX)â€¦" onkeydown="if(event.key==='Enter') searchCity()">
      <button class="map-search-btn" onclick="searchCity()">Search City</button>
    </div>
    <div class="map-status" id="mapStatus">
      <div class="mini-spinner"></div>
      <span id="mapStatusText">Loadingâ€¦</span>
    </div>
    <div id="map"></div>
    <div class="map-legend">
      <div class="legend-item"><div class="legend-dot" style="background:#2d4a32"></div> Residential</div>
      <div class="legend-item"><div class="legend-dot" style="background:#a8893a"></div> Commercial</div>
      <div class="legend-item"><div class="legend-dot" style="background:#d4bc7a;border:1px dashed #a8893a"></div> City Boundary</div>
    </div>

    <!-- Detail panel inside map container -->
    <div class="detail-panel" id="detailPanel">
      <button class="panel-close" onclick="closePanel()">&#x2715;</button>
      <div class="panel-img-wrap" id="panelImgWrap">
        <div class="panel-img-overlay"><div class="panel-price" id="pPrice"></div></div>
      </div>
      <div class="panel-body">
        <div class="panel-title" id="pTitle"></div>
        <div class="panel-address" id="pAddr"></div>
        <div class="panel-tags" id="pTags"></div>
        <div id="pMLS"></div>
        <div class="details-grid" id="pGrid"></div>
        <div class="panel-desc" id="pDesc"></div>
        <div class="comments-section">
          <div class="comments-title">Comments <span class="count" id="cCount">0</span></div>
          <div class="comment-form">
            <input type="text" class="c-input" id="cName" placeholder="Your name">
            <textarea class="c-textarea" id="cText" placeholder="Share your thoughtsâ€¦"></textarea>
            <button class="c-submit" onclick="addComment()">Post Comment</button>
          </div>
          <div class="comments-list" id="cList"></div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- FOOTER -->
<footer>
  <strong>ProperTea</strong> &nbsp;Â·&nbsp; Listing data provided by SimplyRETS &amp; local MLS partners &nbsp;Â·&nbsp; All listings subject to change
</footer>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CONFIG â€” replace with real credentials when you have MLS access
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
var SR_USER  = 'simplyrets';
var SR_PASS  = 'simplyrets';
var SR_LIMIT = 25;
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

var listings    = [];
var activeId    = null;
var markers     = {};
var boundaryLayer = null;
var map;
var avatarColors = ['#2d4a32','#a8893a','#3d6644','#5a4a2a','#4a6e50','#7a6030'];

// Seed comments on featured listings for social proof
var seedComments = {
  0: [{id:'s1',author:'Taylor R.',text:'Toured this last Saturday â€” the kitchen is stunning. Price feels fair for the area.',time:'1 day ago',color:'#2d4a32'},
      {id:'s2',author:'Agent Chen',text:'Multiple offers expected by end of week. Act fast!',time:'3 hours ago',color:'#a8893a'}],
  1: [{id:'s3',author:'Marcus D.',text:'Great cap rate on this one. Has anyone done a walkthrough yet?',time:'2 days ago',color:'#3d6644'}],
  2: [{id:'s4',author:'Priya N.',text:'Love the location. Is parking included in the listing?',time:'5 hours ago',color:'#5a4a2a'},
      {id:'s5',author:'Lisa W.',text:'Yes! Two covered spots per unit according to the disclosure.',time:'2 hours ago',color:'#2d4a32'},
      {id:'s6',author:'Bob K.',text:'We submitted an offer yesterday ğŸ¤',time:'45 mins ago',color:'#a8893a'}]
};

// â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.addEventListener('DOMContentLoaded', function(){
  initMap();
  loadInitialListings();
  setupHeroSearch();
});

// â”€â”€ MAP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function initMap(){
  map = L.map('map',{preferCanvas:true}).setView([29.76,-95.36],10);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
    attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
    maxZoom:19
  }).addTo(map);
  setTimeout(function(){ map.invalidateSize(); },400);
}

// â”€â”€ LOAD INITIAL LISTINGS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function loadInitialListings(){
  showSkeletons();
  var auth = 'Basic ' + btoa(SR_USER+':'+SR_PASS);
  fetch('https://api.simplyrets.com/properties?limit='+SR_LIMIT+'&status=Active',{
    headers:{ 'Authorization':auth, 'Accept':'application/json' }
  })
  .then(function(r){ if(!r.ok) throw new Error(r.status); return r.json(); })
  .then(function(data){
    listings = data.map(mapListing);
    // Inject seed comments for social proof on first few
    [0,1,2].forEach(function(i){ if(listings[i] && seedComments[i]) listings[i].comments = seedComments[i]; });
    renderFeatured();
    addMapMarkers();
    updateStats();
    var coords = listings.filter(function(l){ return l.lat&&l.lng; }).map(function(l){ return [l.lat,l.lng]; });
    if(coords.length) map.fitBounds(coords,{padding:[60,60]});
  })
  .catch(function(e){ console.error(e); renderFeaturedError(); });
}

// â”€â”€ CITY SEARCH â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Uses Photon (photon.komoot.io) â€” CORS-friendly, no API key required
function searchCity(){
  var city = document.getElementById('mapCityInput').value.trim();
  if(!city) return;
  setMapStatus('Finding "'+city+'"â€¦', true);
  closePanel();

  // Photon geocoder â€” reliable CORS support, powered by OpenStreetMap
  fetch('https://photon.komoot.io/api/?q='+encodeURIComponent(city)+'&limit=1&lang=en')
    .then(function(r){ if(!r.ok) throw new Error(r.status); return r.json(); })
    .then(function(data){
      if(!data.features||!data.features.length){
        setMapStatus('City not found. Try "Houston, TX" or "Austin, TX"', false);
        setTimeout(hideMapStatus, 4000); return;
      }

      var feature = data.features[0];
      var coords  = feature.geometry.coordinates; // [lng, lat]
      var lat = coords[1], lng = coords[0];
      var props = feature.properties;

      // Build a bounding box around the city centre (~25km radius)
      var delta = 0.22;
      var bounds = L.latLngBounds([lat-delta, lng-delta], [lat+delta, lng+delta]);

      // Draw boundary & fit map
      drawBoundary(bounds);
      map.fitBounds(bounds, {padding:[30,30]});

      // Show sandbox notice â€” SimplyRETS sandbox has fixed Houston-area data
      // When you have real credentials the q= param will filter by city
      var cityName = props.city || props.name || city;
      setMapStatus('Loading listingsâ€¦ (sandbox data shown)', true);

      var auth = 'Basic ' + btoa(SR_USER+':'+SR_PASS);
      // Try city name filter first; sandbox may ignore it but real creds will use it
      fetch('https://api.simplyrets.com/properties?limit='+SR_LIMIT+'&status=Active',{
        headers:{ 'Authorization':auth, 'Accept':'application/json' }
      })
      .then(function(r){ if(!r.ok) throw new Error(r.status); return r.json(); })
      .then(function(data){
        listings = data.map(mapListing);
        clearMapMarkers();
        addMapMarkers();
        updateStats();

        // Check if sandbox data is geographically near searched city
        var hasGeoData = listings.filter(function(l){ return l.lat&&l.lng; }).length;
        var sandboxOnly = hasGeoData > 0 && listings[0] && listings[0].lat &&
                          Math.abs(listings[0].lat - lat) > 3;

        if(sandboxOnly){
          setMapStatus('ğŸ“ Boundary set for '+cityName+' Â· Showing SimplyRETS sandbox listings (Houston area). Replace credentials for local data.', false);
          setTimeout(hideMapStatus, 6000);
          // Fit to actual marker locations so map isn't empty
          var markerCoords = listings.filter(function(l){ return l.lat&&l.lng; }).map(function(l){ return [l.lat,l.lng]; });
          if(markerCoords.length) map.fitBounds(markerCoords,{padding:[60,60]});
        } else {
          setMapStatus('Found '+listings.length+' listing'+(listings.length!==1?'s':'')+' near '+cityName, false);
          setTimeout(hideMapStatus, 3000);
        }
        renderFeatured();
      })
      .catch(function(e){
        console.error(e);
        setMapStatus('Could not load listings. Check credentials.', false);
        setTimeout(hideMapStatus, 4000);
      });
    })
    .catch(function(e){
      console.error('Photon geocoding error:', e);
      setMapStatus('Geocoding unavailable. Try again shortly.', false);
      setTimeout(hideMapStatus, 4000);
    });
}

function heroSearchGo(){
  var val = document.getElementById('heroSearch').value.trim();
  if(!val) return;
  document.getElementById('mapCityInput').value = val;
  document.getElementById('heroSuggestions').classList.remove('show');
  document.getElementById('map-section').scrollIntoView({behavior:'smooth'});
  setTimeout(searchCity, 600);
}

// â”€â”€ BOUNDARY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function drawBoundary(bounds){
  if(boundaryLayer) map.removeLayer(boundaryLayer);
  boundaryLayer = L.rectangle(bounds, {
    className:'city-boundary',
    fillColor:'#a8893a', fillOpacity:0.06,
    color:'#a8893a', weight:2, dashArray:'8,5'
  }).addTo(map);
}

// â”€â”€ MARKERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function addMapMarkers(){
  listings.forEach(function(l){
    if(!l.lat||!l.lng) return;
    var m = L.marker([l.lat,l.lng],{icon:mkIcon(l,false)});
    m.bindPopup(L.popup({closeButton:false,maxWidth:230}).setContent(
      '<div class="popup-inner"><strong>'+esc(l.title)+'</strong><small>'+esc(l.address)+'</small>'+
      '<button class="popup-btn" onclick="openListing(\''+l.id+'\')">View Details &amp; Comments</button></div>'
    ));
    m.on('click',function(){ resetIcons(); if(markers[l.id]) markers[l.id].setIcon(mkIcon(l,true)); });
    m.addTo(map);
    markers[l.id] = m;
  });
}

function clearMapMarkers(){
  Object.values(markers).forEach(function(m){ map.removeLayer(m); });
  markers = {};
}

function mkIcon(l,sel){
  var bg=sel?'#a8893a':'#2d4a32', fg='#fdfbf5';
  var bd=l.type==='residential'?'#4e7d56':'#a8893a';
  var h='<div style="background:'+bg+';color:'+fg+';padding:5px 10px;border-radius:18px;font-size:10px;font-weight:700;white-space:nowrap;cursor:pointer;font-family:DM Sans,sans-serif;box-shadow:0 3px 10px rgba(28,43,30,.4);border:2px solid '+bd+';position:relative;">'+l.price+'<div style="position:absolute;bottom:-8px;left:50%;transform:translateX(-50%);border:6px solid transparent;border-top-color:'+bg+';border-bottom:none;"></div></div>';
  return L.divIcon({html:h,className:'',iconAnchor:[46,34],popupAnchor:[0,-38]});
}
function resetIcons(){ listings.forEach(function(l){ if(markers[l.id]) markers[l.id].setIcon(mkIcon(l,false)); }); }

// â”€â”€ FEATURED CAROUSEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderFeatured(){
  var carousel = document.getElementById('featuredCarousel');
  carousel.innerHTML = '';
  var featured = listings.slice(0,8);
  featured.forEach(function(l,i){
    var card = document.createElement('div');
    card.className = 'feat-card';
    var imgHtml = l.img
      ? '<img src="'+esc(l.img)+'" loading="lazy" alt="'+esc(l.title)+'">'
      : '<div class="no-photo">ğŸ¡</div>';
    var cc = l.comments.length;
    var hot = cc >= 2;
    card.innerHTML =
      '<div class="feat-card-img">'+imgHtml+
      '<span class="feat-badge '+l.type+'">'+l.type+'</span>'+
      '<span class="feat-status '+l.status+'">'+l.status+'</span>'+
      (hot?'<div class="feat-hot">ğŸ”¥ '+cc+' comments</div>':'')+
      '</div>'+
      '<div class="feat-card-body">'+
        '<div class="feat-price">'+l.price+'</div>'+
        '<div class="feat-title">'+esc(l.title)+'</div>'+
        '<div class="feat-addr">'+esc(l.address)+'</div>'+
        '<div class="feat-meta">'+
          (l.beds!=='â€”'?'<span>ğŸ› '+l.beds+'</span>':'')+
          (l.baths!=='â€”'?'<span>ğŸ› '+l.baths+'</span>':'')+
          '<span>ğŸ“ '+l.sqft+' sqft</span>'+
        '</div>'+
        (cc>0?'<div class="feat-comments">ğŸ’¬ '+cc+' comment'+(cc!==1?'s':'')+'</div>':'')+
      '</div>';
    card.addEventListener('click',function(){
      document.getElementById('map-section').scrollIntoView({behavior:'smooth'});
      setTimeout(function(){ openListing(l.id); },400);
    });
    carousel.appendChild(card);
  });
}

function renderFeaturedError(){
  document.getElementById('featuredCarousel').innerHTML =
    '<div style="padding:40px;color:var(--slate);font-size:0.85rem;">Could not load featured listings. Please refresh.</div>';
}

function showSkeletons(){
  var c = document.getElementById('featuredCarousel');
  c.innerHTML = '';
  for(var i=0;i<5;i++) c.innerHTML += '<div class="skel-card"></div>';
}

function scrollCarousel(dir){
  var c = document.getElementById('featuredCarousel');
  c.scrollBy({left: dir * 300, behavior:'smooth'});
}

// â”€â”€ DETAIL PANEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openListing(id){
  activeId = id;
  var l = listings.find(function(x){ return x.id===id; });
  if(!l) return;

  if(l.lat&&l.lng){
    map.flyTo([l.lat,l.lng],15,{duration:1});
    resetIcons();
    if(markers[id]){ markers[id].setIcon(mkIcon(l,true)); markers[id].openPopup(); }
  }

  var imgWrap = document.getElementById('panelImgWrap');
  imgWrap.innerHTML = '';
  if(l.img){ var img=document.createElement('img'); img.src=l.img; img.alt=l.title; imgWrap.appendChild(img); }
  else { var ph=document.createElement('div'); ph.className='no-photo-lg'; ph.textContent='ğŸ¡'; imgWrap.appendChild(ph); }
  var ov=document.createElement('div'); ov.className='panel-img-overlay'; ov.innerHTML='<div class="panel-price">'+l.price+'</div>'; imgWrap.appendChild(ov);

  document.getElementById('pTitle').textContent = l.title;
  document.getElementById('pAddr').textContent  = l.address;
  document.getElementById('pTags').innerHTML =
    '<span class="panel-tag type-'+l.type+'">'+cap(l.type)+'</span>'+
    '<span class="panel-tag tag-'+l.status+'">'+cap(l.status)+'</span>'+
    (l.subType?'<span class="panel-tag">'+esc(l.subType)+'</span>':'')+
    (l.year!=='â€”'?'<span class="panel-tag">Built '+l.year+'</span>':'');
  document.getElementById('pMLS').innerHTML =
    '<div class="mls-badge">ğŸ“‹ MLS# <strong>'+esc(String(l.mlsId))+'</strong>'+
    (l.agentName?' &nbsp;|&nbsp; <strong>'+esc(l.agentName)+'</strong>':'')+
    '</div>';
  document.getElementById('pGrid').innerHTML =
    dItem('Price',l.price)+dItem('Sq Ft',l.sqft)+
    (l.type==='residential'?dItem('Beds',l.beds)+dItem('Baths',l.baths):'')+
    dItem('Year Built',l.year)+dItem('Lot Size',l.lotSize);
  document.getElementById('pDesc').textContent = l.desc;
  renderComments(l);
  document.getElementById('detailPanel').classList.add('open');
}

function dItem(l,v){ return '<div class="detail-item"><label>'+l+'</label><span>'+v+'</span></div>'; }

function closePanel(){
  document.getElementById('detailPanel').classList.remove('open');
  activeId=null; resetIcons(); if(map) map.closePopup();
}

// â”€â”€ COMMENTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderComments(l){
  document.getElementById('cCount').textContent = l.comments.length;
  var list = document.getElementById('cList');
  if(!l.comments.length){ list.innerHTML='<div class="no-comments">ğŸ’¬ No comments yet â€” be the first!</div>'; return; }
  list.innerHTML = l.comments.map(function(c,i){
    var col=c.color||avatarColors[i%avatarColors.length];
    return '<div class="comment-item"><div class="comment-header">'+
      '<div class="c-avatar" style="background:'+col+'">'+esc(c.author.charAt(0).toUpperCase())+'</div>'+
      '<div class="c-meta"><div class="c-name">'+esc(c.author)+'</div><div class="c-time">'+c.time+'</div></div>'+
      '<button class="c-del" onclick="delComment(\''+l.id+'\',\''+c.id+'\')">&#x2715;</button>'+
      '</div><div class="c-text">'+esc(c.text)+'</div></div>';
  }).join('');
}

function addComment(){
  if(!activeId) return;
  var l=listings.find(function(x){ return x.id===activeId; });
  var name=document.getElementById('cName').value.trim();
  var text=document.getElementById('cText').value.trim();
  if(!name||!text){ alert('Please enter your name and a comment.'); return; }
  l.comments.push({id:'c'+Date.now(),author:name,text:text,time:'Just now',color:avatarColors[l.comments.length%avatarColors.length]});
  document.getElementById('cName').value=''; document.getElementById('cText').value='';
  renderComments(l);
}

function delComment(lid,cid){
  var l=listings.find(function(x){ return x.id===lid; }); if(!l) return;
  l.comments=l.comments.filter(function(c){ return c.id!==cid; });
  renderComments(l);
}

// â”€â”€ GOSSIP STATS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateStats(){
  // Total comments across all loaded listings
  var totalComments = listings.reduce(function(s,l){ return s+l.comments.length; },0);
  // Extrapolate to "week" scale for fun â€” multiply by a plausible weekly factor
  var weeklyComments = totalComments + Math.floor(listings.length * 3.7);
  // Listings with at least 1 comment = "being talked about"
  var hotCount = listings.filter(function(l){ return l.comments.length>0; }).length;
  // Fake but believable "nosy neighbours online" â€” seeded from listing count so it feels live
  var nosy = 40 + Math.floor(listings.length * 2.3) + Math.floor(Math.random()*12);
  // Cups of tea = total comments + views proxy, always a fun big number
  var tea = weeklyComments * 4 + listings.length * 7;

  animateCount('statComments', weeklyComments);
  animateCount('statHot', hotCount);
  animateCount('statNosy', nosy);
  animateCount('statTea', tea);
}

function animateCount(id, target){
  var el = document.getElementById(id);
  if(!el) return;
  var start = 0, duration = 1200, startTime = null;
  function step(ts){
    if(!startTime) startTime = ts;
    var progress = Math.min((ts-startTime)/duration, 1);
    var ease = 1 - Math.pow(1-progress, 3);
    el.textContent = Math.floor(ease * target);
    if(progress < 1) requestAnimationFrame(step);
    else el.textContent = target;
  }
  requestAnimationFrame(step);
}

// â”€â”€ HERO SEARCH SUGGESTIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var popularCities = [
  {name:'Houston, TX',sub:'Harris County'},
  {name:'Austin, TX',sub:'Travis County'},
  {name:'Dallas, TX',sub:'Dallas County'},
  {name:'Denver, CO',sub:'Denver County'},
  {name:'Phoenix, AZ',sub:'Maricopa County'},
  {name:'Nashville, TN',sub:'Davidson County'},
  {name:'Atlanta, GA',sub:'Fulton County'},
  {name:'Charlotte, NC',sub:'Mecklenburg County'},
];

function setupHeroSearch(){
  var input = document.getElementById('heroSearch');
  var sugg  = document.getElementById('heroSuggestions');
  input.addEventListener('input', function(){
    var val = input.value.trim().toLowerCase();
    if(!val){ sugg.classList.remove('show'); return; }
    var matches = popularCities.filter(function(c){ return c.name.toLowerCase().indexOf(val)>-1; });
    if(!matches.length){ sugg.classList.remove('show'); return; }
    sugg.innerHTML = matches.map(function(c){
      return '<div class="suggestion-item" onclick="selectSuggestion(\''+c.name+'\')">ğŸ“ '+c.name+' <span>'+c.sub+'</span></div>';
    }).join('');
    sugg.classList.add('show');
  });
  input.addEventListener('keydown', function(e){ if(e.key==='Enter') heroSearchGo(); });
  document.addEventListener('click', function(e){ if(!e.target.closest('.search-wrap')) sugg.classList.remove('show'); });
}

function selectSuggestion(name){
  document.getElementById('heroSearch').value = name;
  document.getElementById('heroSuggestions').classList.remove('show');
}

// â”€â”€ MAP STATUS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function setMapStatus(msg, loading){
  var el = document.getElementById('mapStatus');
  document.getElementById('mapStatusText').textContent = msg;
  el.querySelector('.mini-spinner').style.display = loading ? 'block' : 'none';
  el.classList.add('show');
}
function hideMapStatus(){ document.getElementById('mapStatus').classList.remove('show'); }

// â”€â”€ DATA MAPPING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function mapListing(p){
  var prop=p.property||{}, addr=p.address||{}, geo=p.geo||{}, agent=p.agent||{};
  var subType=(prop.subType||prop.type||'').toLowerCase();
  var type=subType.indexOf('commercial')>-1||subType.indexOf('business')>-1?'commercial':'residential';
  var rawStatus=(p.mls&&p.mls.status)?p.mls.status.toLowerCase():'active';
  var status=rawStatus.indexOf('pend')>-1?'pending':rawStatus.indexOf('clos')>-1?'closed':'active';
  var fullAddr=[addr.streetNumber,addr.streetName,addr.city,addr.state,addr.postalCode].filter(Boolean).join(' ');
  var photos=p.photos||[];
  return {
    id:p.mlsId||String(Math.random()), mlsId:p.mlsId||'â€”', type:type,
    subType:prop.subType||prop.type||'Residential', status:status,
    rawPrice:p.listPrice||0,
    price:p.listPrice?'$'+Number(p.listPrice).toLocaleString():'Price N/A',
    title:prop.style||prop.subType||'Property', address:fullAddr||'Address unavailable',
    beds:prop.bedrooms||'â€”', baths:prop.bathsFull||'â€”',
    sqft:prop.area?Number(prop.area).toLocaleString():'â€”',
    year:prop.yearBuilt||'â€”', lotSize:prop.lotSize?prop.lotSize+' acres':'â€”',
    desc:p.remarks||'No description provided.',
    img:photos.length?photos[0]:null,
    lat:geo.lat||null, lng:geo.lng||null,
    agentName:agent.firstName?agent.firstName+' '+(agent.lastName||''):null,
    comments:[]
  };
}

function scrollToMap(){ document.getElementById('map-section').scrollIntoView({behavior:'smooth'}); }
function esc(s){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }
function cap(s){ return s.charAt(0).toUpperCase()+s.slice(1); }

window.addEventListener('resize',function(){ if(map) setTimeout(function(){ map.invalidateSize(); },100); });
window.addEventListener('load',function(){ if(map) setTimeout(function(){ map.invalidateSize(); },200); });
</script>
</body>
</html>
