<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ProperTea ‚Äî Stats</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --lime:#8dc63f;--lime-dark:#6aab28;--forest:#2d4a1e;
  --paper:#f4f7ee;--cream:#e6edda;--white:#fbfdf8;
}
html,body{height:100%;background:var(--forest)}
body{
  font-family:'DM Sans',sans-serif;
  background:var(--forest);
  display:grid;grid-template-columns:repeat(4,1fr);
  min-height:100%;
}
/* Responsive: 2-col on small screens */
@media(max-width:600px){
  body{grid-template-columns:repeat(2,1fr)}
}
.stat-cell{
  padding:32px 20px;text-align:center;
  border-right:1px solid rgba(141,198,63,0.12);
  border-bottom:1px solid rgba(141,198,63,0.08);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  transition:background 0.3s;cursor:default;
}
.stat-cell:nth-child(4n){border-right:none}
@media(max-width:600px){
  .stat-cell:nth-child(2n){border-right:none}
  .stat-cell:nth-child(4n){border-right:1px solid rgba(141,198,63,0.12)}
}
.stat-cell:hover{background:rgba(141,198,63,0.06)}
.emoji{font-size:1.5rem;margin-bottom:8px;display:block;line-height:1}
.num{
  font-family:'Playfair Display',serif;
  font-size:clamp(1.6rem,3vw,2.2rem);
  font-weight:700;color:var(--lime);
  display:block;line-height:1;margin-bottom:6px;
  letter-spacing:-0.01em;
}
.label{
  font-size:clamp(0.6rem,1.2vw,0.72rem);
  color:rgba(245,253,248,0.45);
  text-transform:uppercase;letter-spacing:0.08em;font-weight:500;
  line-height:1.3;max-width:110px;
}
</style>
</head>
<body>
  <div class="stat-cell"><span class="emoji">üí¨</span><span class="num" id="s1">‚Äî</span><span class="label">Comments This Week</span></div>
  <div class="stat-cell"><span class="emoji">üî•</span><span class="num" id="s2">‚Äî</span><span class="label">Listings Being Talked About</span></div>
  <div class="stat-cell"><span class="emoji">üëÄ</span><span class="num" id="s3">‚Äî</span><span class="label">Nosy Neighbours Online</span></div>
  <div class="stat-cell"><span class="emoji">üçµ</span><span class="num" id="s4">‚Äî</span><span class="label">Cups of Tea Spilled</span></div>

<script>
var SR_USER='simplyrets',SR_PASS='simplyrets';
var FALLBACK={comments:94,hot:8,nosy:67,tea:412};

function animCount(id,target){
  var el=document.getElementById(id);if(!el)return;
  var start=null,dur=1400;
  requestAnimationFrame(function step(ts){
    if(!start)start=ts;
    var p=Math.min((ts-start)/dur,1),e=1-Math.pow(1-p,3);
    el.textContent=Math.floor(e*target);
    if(p<1)requestAnimationFrame(step);else el.textContent=target;
  });
}

function setStats(listings){
  var totalC=listings.reduce(function(s,l){return s+(l.comments||[]).length;},0);
  var weekly=totalC+Math.floor(listings.length*3.7);
  var hot=listings.filter(function(l){return(l.comments||[]).length>0;}).length;
  var nosy=40+Math.floor(listings.length*2.3)+Math.floor(Math.random()*14);
  var tea=weekly*4+listings.length*7;
  animCount('s1',Math.max(weekly,FALLBACK.comments));
  animCount('s2',Math.max(hot,FALLBACK.hot));
  animCount('s3',Math.max(nosy,FALLBACK.nosy));
  animCount('s4',Math.max(tea,FALLBACK.tea));
}

// Try live data; fall back gracefully
var auth='Basic '+btoa(SR_USER+':'+SR_PASS);
fetch('https://api.simplyrets.com/properties?limit=25&status=Active',{
  headers:{'Authorization':auth,'Accept':'application/json'}
})
.then(function(r){if(!r.ok)throw new Error();return r.json();})
.then(function(data){setStats(data);})
.catch(function(){
  animCount('s1',FALLBACK.comments);
  animCount('s2',FALLBACK.hot);
  animCount('s3',FALLBACK.nosy);
  animCount('s4',FALLBACK.tea);
});
</script>
</body>
</html>
